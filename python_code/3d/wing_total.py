import numpy as np

def wing_total(Xb, nXb, Nb, Xc, nXc, Nc):
    """
    Combine wing border and center elements
    
    Parameters
    ----------
        Xb: ndarray[j, n, i]

        nXb: int

        Nb: ndarray[j, i]

        Xc: ndarray[j, n, i]

        nXc: int

        Nc: ndarray[j, i]

    Returns
    -------
        Xc: ndarray[j, n, i]
            Reduced Xc (centroid removed, n = 1:4)
        Xb: ndarray[j, n, i]
            Reduced Xb (centroid removed, n = 1:4)
        Xt: ndarray[j, n, i]
            Coordinates of total elements on the wing
        nXt: int
            Number of total elements on the wing
        XC: ndarray[j, i]
            Coordinates of the total collocation points on the wing
        NC: ndarray[j, i]
            Unit normal at the total collocation points on the wing
    """
    # Initialization
    nXt = nXb + nXc
    XC = np.zeros((3, nXt))
    NC = np.zeros((3, nXt))
    Xt = np.zeros((3, 4, nXt))

    # Node points (excluding the collocation points)
    Xt[:, :, 0:nXb]   = Xb[:, 0:4, :]
    Xt[:, :, nXb:nXt] = Xc[:, 0:4, :]

    # Collocation points
    XC[:, 0:nXb]   = Xb[:, 4, :]
    XC[:, nXb:nXt] = Xc[:, 4, :]

    # Unit normal
    NC[:, 0:nXb]   = Nb
    NC[:, nXb:nXt] = Nc

    # Redefine Xb and Xc
    tmp = Xb[:, 0:4, :]
    Xb = np.zeros((3, 4, nXb))
    Xb = tmp
    tmp = Xc[:, 0:4, :]
    Xc = np.zeros((3, 4, nXc))
    Xc = tmp

    return Xc, Xb, Xt, nXt, XC, NC


if __name__ == "__main__":
    nXb = 10
    Xb = np.zeros((3, 5, nXb))
    Nb = np.zeros((3, nXb))
    Nb[2, :] = 1

    nXc = 7
    Xc = np.zeros((3, 5, nXc))
    Nc = np.zeros((3, nXc))
    Nc[2, :] = 1

    Xb[:, :, 0] = [
        [0,   -0.0704,   -0.0491,    0.0000,   -0.0299],
        [0,    0.1219,    0.1342,    0.0491,    0.0763],
        [0,         0,         0,         0,         0],
    ]

    Xb[:, :, 1] = [
        [-0.0704,   -0.1228,   -0.0983,   -0.0491,   -0.0852],
        [ 0.1219,    0.2127,    0.2193,    0.1342,    0.1720],
        [      0,         0,         0,         0,         0],
    ]

    Xb[:, :, 2] = [
        [-0.1228,   -0.1228,   -0.0983,   -0.0983,   -0.1105],
        [ 0.2127,    0.3266,    0.3266,    0.2193,    0.2713],
        [      0,         0,         0,         0,         0],
    ]

    Xb[:, :, 3] = [
        [-0.1228,   -0.1228,   -0.0983,   -0.0983,   -0.1105],
        [ 0.3266,    0.4584,    0.4338,    0.3266,    0.3863],
        [      0,         0,         0,         0,         0],
    ]

    Xb[:, :, 4] = [
        [-0.1228,    0.0000,    0.0000,   -0.0983,   -0.0553],
        [ 0.4584,    0.4584,    0.4338,    0.4338,    0.4461],
        [      0,         0,         0,         0,         0],
    ]

    Xb[:, :, 5] = [
        [0.0000,    0.1228,    0.0983,    0.0000,    0.0553],
        [0.4584,    0.4584,    0.4338,    0.4338,    0.4461],
        [     0,         0,         0,         0,         0],
 
    ]

    Xb[:, :, 6] = [
        [0.1228,    0.1228,    0.0983,    0.0983,    0.1105],
        [0.4584,    0.3266,    0.3266,    0.4338,    0.3863],
        [     0,         0,         0,         0,         0],
    ]

    Xb[:, :, 7] = [
        [0.1228,    0.1228,    0.0983,    0.0983,    0.1105],
        [0.3266,    0.2127,    0.2193,    0.3266,    0.2713],
        [     0,         0,         0,         0,         0],
    ]

    Xb[:, :, 8] = [
        [0.1228,    0.0704,    0.0491,    0.0983,    0.0852],
        [0.2127,    0.1219,    0.1342,    0.2193,    0.1720],
        [     0,         0,         0,         0,         0],
    ]

    Xb[:, :, 9] = [
        [0.0704,    0.0000,    0.0000,    0.0491,    0.0299],
        [0.1219,   -0.0000,    0.0491,    0.1342,    0.0763],
        [     0,         0,         0,         0,         0],
    ]

    
    Xc[:, :, 0] = [
        [     0,   -0.0491,         0,    0.0491,    0.0000],
        [0.0491,    0.1342,    0.1342,    0.1342,    0.1129],
        [     0,         0,         0,         0,         0],
    ]

    Xc[:, :, 1] = [
        [-0.0491,   -0.0983,    0.0000,    0.0000,   -0.0368],
        [ 0.1342,    0.2193,    0.2193,    0.1342,    0.1768],
        [      0,         0,         0,         0,         0],
    ]

    Xc[:, :, 2] = [
        [0.0000,    0.0000,    0.0983,    0.0491,    0.0368],
        [0.1342,    0.2193,    0.2193,    0.1342,    0.1768],
        [     0,         0,         0,         0,         0],
    ]

    Xc[:, :, 3] = [
        [-0.0983,   -0.0983,    0.0000,    0.0000,   -0.0491],
        [ 0.2193,    0.3266,    0.3266,    0.2193,    0.2729],
        [      0,         0,         0,         0,         0],
    ]

    Xc[:, :, 4] = [
        [0.0000,    0.0000,    0.0983,    0.0983,    0.0491],
        [0.2193,    0.3266,    0.3266,    0.2193,    0.2729],
        [     0,         0,         0,         0,         0],
    ]

    Xc[:, :, 5] = [
        [-0.0983,   -0.0983,    0.0000,    0.0000,   -0.0491],
        [ 0.3266,    0.4338,    0.4338,    0.3266,    0.3802],
        [      0,         0,         0,         0,         0],
    ]

    Xc[:, :, 6] = [
        [0.0000,    0.0000,    0.0983,    0.0983,    0.0491],
        [0.3266,    0.4338,    0.4338,    0.3266,    0.3802],
        [     0,         0,         0,         0,         0],
    ]

    wing_total(Xb, nXb, Nb, Xc, nXc, Nc)
